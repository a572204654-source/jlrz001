# Wordç”Ÿæˆå·¥å…·æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

| é¡¹ç›® | å†…å®¹ |
|-----|------|
| **æ¨¡å—åç§°** | Wordæ–‡æ¡£ç”Ÿæˆå·¥å…· |
| **æ–‡ä»¶è·¯å¾„** | `utils/wordGenerator.js` |
| **ç‰ˆæœ¬** | v1.0.0 |
| **æœ€åæ›´æ–°** | 2024-11-08 |
| **ç»´æŠ¤äºº** | åç«¯å›¢é˜Ÿ |

---

## ğŸ¯ æ¨¡å—æ¦‚è¿°

æœ¬æ¨¡å—æä¾›ç›‘ç†æ—¥å¿—Wordæ–‡æ¡£ç”ŸæˆåŠŸèƒ½ï¼Œä½¿ç”¨ `docx` åº“åˆ›å»ºç¬¦åˆç›‘ç†è¡Œä¸šè§„èŒƒçš„æ ‡å‡†Wordæ–‡æ¡£ã€‚ç”Ÿæˆçš„æ–‡æ¡£åŒ…å«å°é¢é¡µå’Œå†…å®¹é¡µï¼Œæ”¯æŒå¤æ‚è¡¨æ ¼å¸ƒå±€ã€ä¸­æ–‡æ ¼å¼åŒ–ã€å¤šè¡Œæ–‡æœ¬å¤„ç†ç­‰åŠŸèƒ½ã€‚

### ä¸»è¦åŠŸèƒ½
- âœ… ç”Ÿæˆç¬¦åˆç›‘ç†è§„èŒƒçš„Wordæ–‡æ¡£
- âœ… æ”¯æŒä¸¤é¡µæ ¼å¼ï¼ˆå°é¢é¡µ+å†…å®¹é¡µï¼‰
- âœ… å¤æ‚è¡¨æ ¼å¸ƒå±€å’ŒåµŒå¥—è¡¨æ ¼
- âœ… ä¸­æ–‡æ—¥æœŸæ ¼å¼åŒ–
- âœ… è‡ªåŠ¨æ–‡æœ¬æ¢è¡Œå’Œç¼©è¿›
- âœ… çºµå‘æ–‡å­—æ’ç‰ˆ
- âœ… ç­¾åæ å·¦å³å¯¹é½

---

## ğŸ“¦ ä¾èµ–é¡¹

### NPMåŒ…ä¾èµ–

```json
{
  "dependencies": {
    "docx": "^8.0.0"
  }
}
```

### å¯¼å…¥çš„æ¨¡å—

```javascript
const { 
  Document,           // Wordæ–‡æ¡£å¯¹è±¡
  Packer,            // æ–‡æ¡£æ‰“åŒ…å™¨ï¼ˆç”ŸæˆBufferï¼‰
  Paragraph,         // æ®µè½
  Table,             // è¡¨æ ¼
  TableCell,         // è¡¨æ ¼å•å…ƒæ ¼
  TableRow,          // è¡¨æ ¼è¡Œ
  WidthType,         // å®½åº¦ç±»å‹æšä¸¾
  AlignmentType,     // å¯¹é½æ–¹å¼æšä¸¾
  VerticalAlign,     // å‚ç›´å¯¹é½æšä¸¾
  BorderStyle,       // è¾¹æ¡†æ ·å¼æšä¸¾
  TextRun,           // æ–‡æœ¬è¿è¡Œå¯¹è±¡
  PageBreak          // åˆ†é¡µç¬¦
} = require('docx')
```

---

## ğŸ”§ æ ¸å¿ƒæ–¹æ³•

### generateSupervisionLogWord(logData)

ç”Ÿæˆç›‘ç†æ—¥å¿—Wordæ–‡æ¡£çš„ä¸»æ–¹æ³•ã€‚

#### æ–¹æ³•ç­¾å

```javascript
/**
 * ç”Ÿæˆç›‘ç†æ—¥å¿—Wordæ–‡æ¡£ï¼ˆæŒ‰ç…§æ ‡å‡†æ ¼å¼1:1è¿˜åŸï¼‰
 * @param {Object} logData - ç›‘ç†æ—¥å¿—æ•°æ®
 * @returns {Promise<Buffer>} Wordæ–‡æ¡£Buffer
 */
async function generateSupervisionLogWord(logData)
```

#### å‚æ•°è¯´æ˜

**logDataå¯¹è±¡ç»“æ„**:

```javascript
{
  // ========== é¡¹ç›®ä¿¡æ¯ï¼ˆæ¥è‡ªprojectsè¡¨ï¼‰ ==========
  projectName: String,        // é¡¹ç›®åç§° (æˆ– project_name)
  projectCode: String,        // é¡¹ç›®ç¼–å· (æˆ– project_code)
  organization: String,       // ç›‘ç†æœºæ„
  chiefEngineer: String,      // æ€»ç›‘ç†å·¥ç¨‹å¸ˆ (æˆ– chief_engineer)
  projectStartDate: Date,     // é¡¹ç›®å¼€å§‹æ—¥æœŸ (æˆ– project_start_date)
  projectEndDate: Date,       // é¡¹ç›®ç»“æŸæ—¥æœŸ (æˆ– project_end_date)
  
  // ========== å·¥ç¨‹ä¿¡æ¯ï¼ˆæ¥è‡ªworksè¡¨ï¼‰ ==========
  workName: String,           // å·¥ç¨‹åç§° (æˆ– work_name)
  workCode: String,           // å·¥ç¨‹ç¼–å· (æˆ– work_code)
  unitWork: String,           // å•ä½å·¥ç¨‹ (æˆ– unit_work)
  startDate: Date,            // ç›‘ç†æ—¥å¿—å¼€å§‹æ—¶é—´
  endDate: Date,              // ç›‘ç†æ—¥å¿—ç»“æŸæ—¶é—´
  
  // ========== ç”¨æˆ·ä¿¡æ¯ï¼ˆæ¥è‡ªusersè¡¨ï¼‰ ==========
  userName: String,           // å¡«å†™äººå§“å (æˆ– user_name)
  specialistEngineer: String, // ä¸“ä¸šç›‘ç†å·¥ç¨‹å¸ˆ (æˆ– specialist_engineer)
  
  // ========== æ—¥å¿—åŸºæœ¬ä¿¡æ¯ï¼ˆæ¥è‡ªsupervision_logsè¡¨ï¼‰ ==========
  logDate: Date,              // æ—¥å¿—æ—¥æœŸ (æˆ– log_date)
  weather: String,            // æ°”è±¡æƒ…å†µ
  
  // ========== æ—¥å¿—å†…å®¹ï¼ˆæ¥è‡ªsupervision_logsè¡¨ï¼‰ ==========
  projectDynamics: String,    // å·¥ç¨‹åŠ¨æ€ (æˆ– project_dynamics)
  supervisionWork: String,    // ç›‘ç†å·¥ä½œæƒ…å†µ (æˆ– supervision_work)
  safetyWork: String,         // å®‰å…¨ç›‘ç†å·¥ä½œæƒ…å†µ (æˆ– safety_work)
  
  // ========== ç­¾å­—ä¿¡æ¯ï¼ˆæ¥è‡ªsupervision_logsè¡¨ï¼‰ ==========
  recorderName: String,       // è®°å½•äººå§“å (æˆ– recorder_name)
  recorderDate: Date,         // è®°å½•æ—¥æœŸ (æˆ– recorder_date)
  reviewerName: String,       // å®¡æ ¸äººå§“å (æˆ– reviewer_name)
  reviewerDate: Date          // å®¡æ ¸æ—¥æœŸ (æˆ– reviewer_date)
}
```

**è¯´æ˜**:
- å­—æ®µæ”¯æŒé©¼å³°å‘½åå’Œä¸‹åˆ’çº¿å‘½åä¸¤ç§æ–¹å¼
- æ—¥æœŸå­—æ®µå¯ä»¥æ˜¯ Date å¯¹è±¡æˆ–æ—¥æœŸå­—ç¬¦ä¸²
- æ–‡æœ¬å­—æ®µä¸ºç©ºæ—¶æ˜¾ç¤ºä¸ºç©ºç™½

#### è¿”å›å€¼

- **ç±»å‹**: `Promise<Buffer>`
- **è¯´æ˜**: Wordæ–‡æ¡£çš„äºŒè¿›åˆ¶Bufferï¼Œå¯ç›´æ¥å‘é€ç»™å®¢æˆ·ç«¯æˆ–ä¿å­˜åˆ°æ–‡ä»¶

#### ä½¿ç”¨ç¤ºä¾‹

```javascript
const { generateSupervisionLogWord } = require('../utils/wordGenerator')

// å‡†å¤‡æ—¥å¿—æ•°æ®
const logData = {
  projectName: 'æµ‹è¯•é¡¹ç›®',
  projectCode: 'TEST-001',
  organization: 'æµ‹è¯•ç›‘ç†æœºæ„',
  chiefEngineer: 'å¼ æ€»ç›‘',
  workName: 'æµ‹è¯•å·¥ç¨‹',
  workCode: 'WORK-001',
  unitWork: 'ä¸»ä½“å·¥ç¨‹',
  userName: 'æå·¥',
  logDate: new Date('2024-11-08'),
  weather: 'æ™´ï¼Œæ¸©åº¦15-25â„ƒï¼Œä¸œé£3çº§',
  projectDynamics: 'ä»Šæ—¥æ–½å·¥è¿›å±•é¡ºåˆ©...',
  supervisionWork: 'ç›‘ç†äººå‘˜åˆ°åœºç›‘ç£...',
  safetyWork: 'å®‰å…¨æ£€æŸ¥æœªå‘ç°é‡å¤§éšæ‚£...',
  recorderName: 'ç‹å·¥',
  recorderDate: new Date('2024-11-08'),
  reviewerName: 'ææ€»ç›‘',
  reviewerDate: new Date('2024-11-09')
}

// ç”ŸæˆWordæ–‡æ¡£
try {
  const wordBuffer = await generateSupervisionLogWord(logData)
  console.log('Wordæ–‡æ¡£ç”ŸæˆæˆåŠŸï¼Œå¤§å°:', wordBuffer.length, 'å­—èŠ‚')
  
  // ä¿å­˜åˆ°æ–‡ä»¶
  const fs = require('fs')
  fs.writeFileSync('ç›‘ç†æ—¥å¿—.docx', wordBuffer)
  
  // æˆ–é€šè¿‡HTTPå“åº”è¿”å›
  res.setHeader('Content-Type', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document')
  res.setHeader('Content-Disposition', 'attachment; filename="ç›‘ç†æ—¥å¿—.docx"')
  res.send(wordBuffer)
  
} catch (error) {
  console.error('ç”ŸæˆWordæ–‡æ¡£é”™è¯¯:', error)
}
```

#### é”™è¯¯å¤„ç†

```javascript
try {
  const wordBuffer = await generateSupervisionLogWord(logData)
} catch (error) {
  // å¯èƒ½çš„é”™è¯¯ç±»å‹
  // 1. docxåº“å†…éƒ¨é”™è¯¯
  // 2. æ•°æ®æ ¼å¼é”™è¯¯
  // 3. å†…å­˜ä¸è¶³
  console.error('ç”ŸæˆWordæ–‡æ¡£é”™è¯¯:', error.message)
  throw error
}
```

---

## ğŸ› ï¸ è¾…åŠ©æ–¹æ³•

### createCenteredParagraph(text, bold)

åˆ›å»ºå±…ä¸­å¯¹é½çš„æ®µè½ã€‚

```javascript
/**
 * åˆ›å»ºå±…ä¸­å¯¹é½çš„æ®µè½
 * @param {string} text - æ–‡æœ¬å†…å®¹
 * @param {boolean} bold - æ˜¯å¦åŠ ç²—ï¼Œé»˜è®¤false
 * @returns {Paragraph}
 */
function createCenteredParagraph(text, bold = false)
```

**ä½¿ç”¨ç¤ºä¾‹**:
```javascript
const paragraph = createCenteredParagraph('é¡¹ç›®åç§°', false)
const boldParagraph = createCenteredParagraph('ç›‘ç†æ—¥å¿—', true)
```

**é…ç½®**:
- å¯¹é½æ–¹å¼: å±…ä¸­
- å­—ä½“: å®‹ä½“
- å­—å·: 24 (12pt)

---

### createLeftParagraph(text)

åˆ›å»ºå·¦å¯¹é½çš„æ®µè½ã€‚

```javascript
/**
 * åˆ›å»ºå·¦å¯¹é½çš„æ®µè½
 * @param {string} text - æ–‡æœ¬å†…å®¹
 * @returns {Paragraph}
 */
function createLeftParagraph(text)
```

**ä½¿ç”¨ç¤ºä¾‹**:
```javascript
const paragraph = createLeftParagraph('å¼ ä¸‰')
```

**é…ç½®**:
- å¯¹é½æ–¹å¼: å·¦å¯¹é½
- å­—ä½“: å®‹ä½“
- å­—å·: 24 (12pt)

---

### createContentParagraph(text)

åˆ›å»ºå†…å®¹æ®µè½ï¼ˆå¸¦ç¼©è¿›å’Œè¡Œé—´è·ï¼‰ã€‚

```javascript
/**
 * åˆ›å»ºå†…å®¹æ®µè½ï¼ˆå¸¦ç¼©è¿›ï¼‰
 * @param {string} text - æ–‡æœ¬å†…å®¹
 * @returns {Paragraph}
 */
function createContentParagraph(text)
```

**ä½¿ç”¨ç¤ºä¾‹**:
```javascript
const paragraph = createContentParagraph('ä»Šæ—¥æ–½å·¥è¿›å±•é¡ºåˆ©ï¼Œå®Œæˆä¸»ä½“ç»“æ„æµ‡ç­‘...')
```

**é…ç½®**:
- å¯¹é½æ–¹å¼: å·¦å¯¹é½
- å­—ä½“: å®‹ä½“
- å­—å·: 24 (12pt)
- å·¦ç¼©è¿›: 400 twips
- å³ç¼©è¿›: 200 twips
- è¡Œé—´è·: 360 twips
- æ®µå‰é—´è·: 100 twips
- æ®µåé—´è·: 100 twips

---

### formatDate(date)

æ ¼å¼åŒ–æ—¥æœŸä¸ºä¸­æ–‡æ ¼å¼ã€‚

```javascript
/**
 * æ ¼å¼åŒ–æ—¥æœŸ
 * @param {Date|string} date - æ—¥æœŸ
 * @returns {string} æ ¼å¼åŒ–åçš„æ—¥æœŸå­—ç¬¦ä¸²
 */
function formatDate(date)
```

**ä½¿ç”¨ç¤ºä¾‹**:
```javascript
formatDate(new Date('2024-11-08'))
// è¿”å›: "2024å¹´11æœˆ08æ—¥"

formatDate('2024-11-08')
// è¿”å›: "2024å¹´11æœˆ08æ—¥"

formatDate(null)
// è¿”å›: ""
```

**æ ¼å¼**: `YYYYå¹´MMæœˆDDæ—¥`

---

### formatDateRange(startDate, endDate)

æ ¼å¼åŒ–æ—¥æœŸèŒƒå›´ã€‚

```javascript
/**
 * æ ¼å¼åŒ–æ—¥æœŸèŒƒå›´
 * @param {Date|string} startDate - å¼€å§‹æ—¥æœŸ
 * @param {Date|string} endDate - ç»“æŸæ—¥æœŸ
 * @returns {string} æ ¼å¼åŒ–åçš„æ—¥æœŸèŒƒå›´å­—ç¬¦ä¸²
 */
function formatDateRange(startDate, endDate)
```

**ä½¿ç”¨ç¤ºä¾‹**:
```javascript
formatDateRange('2024-01-01', '2024-12-31')
// è¿”å›: "2024å¹´01æœˆ01æ—¥ è‡³ 2024å¹´12æœˆ31æ—¥"

formatDateRange('2024-01-01', null)
// è¿”å›: "2024å¹´01æœˆ01æ—¥ è‡³ä»Š"

formatDateRange(null, '2024-12-31')
// è¿”å›: "è‡³ 2024å¹´12æœˆ31æ—¥"

formatDateRange(null, null)
// è¿”å›: ""
```

---

### formatDateForSignature(date)

æ ¼å¼åŒ–ç­¾åæ—¥æœŸï¼ˆç”¨äºç­¾å­—æ ï¼‰ã€‚

```javascript
/**
 * æ ¼å¼åŒ–ç­¾åæ—¥æœŸï¼ˆå¹´ æœˆ æ—¥æ ¼å¼ï¼Œå¦‚æœ‰æ•°æ®åˆ™å¡«å……ï¼‰
 * @param {Date|string} date - æ—¥æœŸ
 * @returns {string} æ ¼å¼åŒ–åçš„ç­¾åæ—¥æœŸ
 */
function formatDateForSignature(date)
```

**ä½¿ç”¨ç¤ºä¾‹**:
```javascript
formatDateForSignature('2024-11-08')
// è¿”å›: "2024å¹´ 11æœˆ 8æ—¥"

formatDateForSignature(null)
// è¿”å›: "å¹´   æœˆ   æ—¥"
```

**æ ¼å¼**: `YYYYå¹´ Mæœˆ Dæ—¥` ï¼ˆæœˆä»½å’Œæ—¥æœŸä¸è¡¥é›¶ï¼‰

---

## ğŸ“„ æ–‡æ¡£ç»“æ„è¯¦è§£

### æ–‡æ¡£é…ç½®

```javascript
const doc = new Document({
  sections: [{
    properties: {
      page: {
        margin: {
          top: 1440,      // ä¸Šè¾¹è· 1è‹±å¯¸
          right: 720,     // å³è¾¹è· 0.5è‹±å¯¸
          bottom: 1440,   // ä¸‹è¾¹è· 1è‹±å¯¸
          left: 720       // å·¦è¾¹è· 0.5è‹±å¯¸
        }
      }
    },
    children: [
      // é¡µé¢å†…å®¹
    ]
  }]
})
```

---

### ç¬¬ä¸€é¡µï¼šå°é¢é¡µ

#### 1. é¡¶éƒ¨æ ‡é¢˜è¡Œ

```javascript
new Paragraph({
  alignment: AlignmentType.LEFT,
  spacing: { after: 100 },
  children: [
    new TextRun({
      text: 'é™„å½• 11-5 è¡¨        ',
      size: 24,
      font: 'å®‹ä½“'
    }),
    new TextRun({
      text: '                    ç›‘ç†æ—¥å¿—',
      size: 24,
      font: 'å®‹ä½“',
      bold: true
    })
  ]
})
```

**è¯´æ˜**: ä½¿ç”¨ç©ºæ ¼å®ç°å·¦å¯¹é½+å±…ä¸­æ•ˆæœ

---

#### 2. é¡¹ç›®ä¿¡æ¯è¡¨æ ¼

**è¡¨æ ¼ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é¡¹ç›®åç§°    â”‚  [é¡¹ç›®åç§°æ•°æ®ï¼Œåˆå¹¶3åˆ—]            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é¡¹ç›®ç¼–å·    â”‚  [é¡¹ç›®ç¼–å·æ•°æ®ï¼Œåˆå¹¶3åˆ—]            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¤
â”‚å•é¡¹å·¥ç¨‹åç§°  â”‚ [å·¥ç¨‹åç§°]   â”‚å•é¡¹å·¥ç¨‹ç¼–å·  â”‚[ç¼–å·]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
â”‚å•ä½å·¥ç¨‹åç§°  â”‚ [å•ä½å·¥ç¨‹]   â”‚å•ä½å·¥ç¨‹ç¼–å·  â”‚[ç¼–å·]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                    â”‚
â”‚                  ç›‘ç†æ—¥å¿— (å¤§æ ‡é¢˜)                  â”‚
â”‚                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åˆ—å®½é…ç½®**:
```javascript
// è¡Œ1-2: 25% + 75%(åˆå¹¶3åˆ—)
// è¡Œ3-4: 25% + 25% + 25% + 25%
// è¡Œ5: 100%(åˆå¹¶4åˆ—)
```

**ç‰¹æ®Šé…ç½®**:
- å¤§æ ‡é¢˜è¡Œé«˜: 8000 twips
- å¤§æ ‡é¢˜å­—å·: 72 (36pt)
- å¤§æ ‡é¢˜åŠ ç²—
- å•å…ƒæ ¼å‚ç›´å±…ä¸­

---

#### 3. ç›‘ç†æœºæ„ä¿¡æ¯è¡¨æ ¼

**è¡¨æ ¼ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚é¡¹ç›®ç›‘ç†æœºæ„  â”‚  [ç›‘ç†æœºæ„åç§°ï¼Œåˆå¹¶3åˆ—]            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¤
â”‚æ€»ç›‘ç†å·¥ç¨‹å¸ˆ  â”‚ [æ€»ç›‘å§“å]   â”‚ä¸“ä¸šç›‘ç†å·¥ç¨‹å¸ˆâ”‚[å§“å]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¤
â”‚ç›‘ç†æ—¥å¿—      â”‚  [èµ·æ­¢æ—¶é—´ï¼Œåˆå¹¶3åˆ—]                â”‚
â”‚èµ·æ­¢æ—¶é—´      â”‚                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åˆ—å®½é…ç½®**:
```javascript
// è¡Œ1: 25% + 75%(åˆå¹¶3åˆ—)
// è¡Œ2: 25% + 25% + 25% + 25%
// è¡Œ3: 25% + 75%(åˆå¹¶3åˆ—)
```

---

#### 4. åˆ†é¡µç¬¦

```javascript
new Paragraph({
  children: [new PageBreak()]
})
```

---

### ç¬¬äºŒé¡µï¼šå†…å®¹é¡µ

#### 1. é¡µé¢æ ‡é¢˜

```javascript
new Paragraph({
  alignment: AlignmentType.CENTER,
  spacing: { after: 0, line: 240 },
  children: [
    new TextRun({
      text: 'ç›‘ç†æ—¥å¿—',
      size: 24,
      font: 'å®‹ä½“',
      bold: true
    })
  ]
})
```

---

#### 2. åŸºæœ¬ä¿¡æ¯è¡¨æ ¼

**è¡¨æ ¼ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚å•ä½å·¥ç¨‹åç§°  â”‚ [å·¥ç¨‹åç§°]   â”‚å•ä½å·¥ç¨‹ç¼–å·  â”‚  [å·¥ç¨‹ç¼–å·]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚æ—¥    æœŸ      â”‚  [æ—¥å¿—æ—¥æœŸï¼Œåˆå¹¶3åˆ—]                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚æ°”    è±¡      â”‚  [æ°”è±¡æƒ…å†µï¼Œåˆå¹¶3åˆ—]                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åˆ—å®½é…ç½®**:
```javascript
// è¡Œ1: 16% + 34% + 16% + 34%
// è¡Œ2-3: 12% + 88%(åˆå¹¶3åˆ—)
```

**è¡Œé«˜é…ç½®**:
```javascript
height: { value: 400, rule: 'atLeast' }
```

---

#### 3. é›¶é—´è·æ®µè½

```javascript
new Paragraph({
  spacing: { before: 0, after: 0, line: 1 },
  children: []
})
```

**è¯´æ˜**: ç”¨äºè¿æ¥ä¸¤ä¸ªè¡¨æ ¼ï¼Œå®ç°è§†è§‰ä¸Šçš„è¡¨æ ¼è¿ç»­æ•ˆæœ

---

#### 4. å†…å®¹è¡¨æ ¼

**è¡¨æ ¼ç»“æ„**:
```
â”Œâ”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚å·¥â”‚                                                    â”‚
â”‚ç¨‹â”‚  [å·¥ç¨‹åŠ¨æ€å†…å®¹ï¼Œå·¦å¯¹é½ï¼Œå¸¦ç¼©è¿›]                    â”‚
â”‚åŠ¨â”‚                                                    â”‚
â”‚æ€â”‚                                                    â”‚
â”œâ”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ç›‘â”‚                                                    â”‚
â”‚ç†â”‚  [ç›‘ç†å·¥ä½œæƒ…å†µï¼Œå·¦å¯¹é½ï¼Œå¸¦ç¼©è¿›]                    â”‚
â”‚å·¥â”‚                                                    â”‚
â”‚ä½œâ”‚                                                    â”‚
â”‚æƒ…â”‚                                                    â”‚
â”‚å†µâ”‚                                                    â”‚
â”œâ”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚å®‰â”‚                                                    â”‚
â”‚å…¨â”‚  [å®‰å…¨ç›‘ç†å·¥ä½œæƒ…å†µï¼Œå·¦å¯¹é½ï¼Œå¸¦ç¼©è¿›]                â”‚
â”‚ç›‘â”‚                                                    â”‚
â”‚ç†â”‚                                                    â”‚
â”‚å·¥â”‚                                                    â”‚
â”‚ä½œâ”‚                                                    â”‚
â”‚æƒ…â”‚                                                    â”‚
â”‚å†µâ”‚                                                    â”‚
â””â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åˆ—å®½é…ç½®**:
```javascript
æ ‡ç­¾åˆ—: 2%   // çºµå‘æ–‡å­—
å†…å®¹åˆ—: 98%  // å†…å®¹åŒºåŸŸ
```

**è¡Œé«˜é…ç½®**:
```javascript
height: { value: 3400, rule: 'atLeast' }
```

**çºµå‘æ–‡å­—å®ç°**:
```javascript
new Paragraph({
  alignment: AlignmentType.CENTER,
  children: [
    new TextRun({
      text: 'å·¥\nç¨‹\nåŠ¨\næ€',  // ä½¿ç”¨æ¢è¡Œç¬¦å®ç°çºµå‘æ’åˆ—
      size: 24,
      font: 'å®‹ä½“'
    })
  ]
})
```

---

#### 5. é›¶é—´è·æ®µè½

åŒä¸Šï¼Œè¿æ¥å†…å®¹è¡¨æ ¼å’Œç­¾å­—æ è¡¨æ ¼ã€‚

---

#### 6. ç­¾å­—æ è¡¨æ ¼

**è¡¨æ ¼ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚è®°å½•äºº  â”‚  å§“å (å·¦)  æ—¥æœŸ(å³)â”‚å®¡æ ¸äºº  â”‚  å§“å (å·¦)  æ—¥æœŸ(å³)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¤–å±‚è¡¨æ ¼åˆ—å®½**:
```javascript
åˆ—1: 8%   // è®°å½•äººæ ‡ç­¾
åˆ—2: 34%  // è®°å½•äººç­¾å+æ—¥æœŸ
åˆ—3: 8%   // å®¡æ ¸äººæ ‡ç­¾
åˆ—4: 50%  // å®¡æ ¸äººç­¾å+æ—¥æœŸ
```

**å†…åµŒè¡¨æ ¼**ï¼ˆç­¾å+æ—¥æœŸï¼‰:
```javascript
// æ— è¾¹æ¡†è¡¨æ ¼
new Table({
  borders: {
    top: { style: BorderStyle.NONE },
    bottom: { style: BorderStyle.NONE },
    left: { style: BorderStyle.NONE },
    right: { style: BorderStyle.NONE },
    insideHorizontal: { style: BorderStyle.NONE },
    insideVertical: { style: BorderStyle.NONE }
  },
  rows: [
    new TableRow({
      children: [
        new TableCell({
          width: { size: 30, type: WidthType.PERCENTAGE },
          children: [createLeftParagraph(å§“å)]  // å·¦å¯¹é½
        }),
        new TableCell({
          width: { size: 70, type: WidthType.PERCENTAGE },
          children: [
            new Paragraph({
              alignment: AlignmentType.RIGHT,  // å³å¯¹é½
              children: [new TextRun({ text: æ—¥æœŸ })]
            })
          ]
        })
      ]
    })
  ]
})
```

---

## ğŸ¨ æ ·å¼å¸¸é‡

### å­—å·å¸¸é‡

```javascript
const FONT_SIZES = {
  TITLE: 72,        // å¤§æ ‡é¢˜ 36pt
  NORMAL: 24,       // æ­£å¸¸æ–‡æœ¬ 12pt
  SMALL: 20         // å°å­— 10pt
}
```

### è¡Œé«˜å¸¸é‡

```javascript
const ROW_HEIGHTS = {
  SMALL: 400,       // å°è¡Œé«˜
  NORMAL: 800,      // æ­£å¸¸è¡Œé«˜
  LARGE: 3400,      // å¤§è¡Œé«˜ï¼ˆå†…å®¹åŒºï¼‰
  TITLE: 8000       // æ ‡é¢˜è¡Œé«˜
}
```

### åˆ—å®½å¸¸é‡

```javascript
const COLUMN_WIDTHS = {
  LABEL_NARROW: 2,    // çª„æ ‡ç­¾åˆ—ï¼ˆçºµå‘æ–‡å­—ï¼‰
  LABEL_SMALL: 8,     // å°æ ‡ç­¾åˆ—
  LABEL_NORMAL: 12,   // æ™®é€šæ ‡ç­¾åˆ—
  LABEL_MEDIUM: 16,   // ä¸­ç­‰æ ‡ç­¾åˆ—
  LABEL_WIDE: 25,     // å®½æ ‡ç­¾åˆ—
  DATA_SMALL: 25,     // å°æ•°æ®åˆ—
  DATA_MEDIUM: 34,    // ä¸­ç­‰æ•°æ®åˆ—
  DATA_LARGE: 50,     // å¤§æ•°æ®åˆ—
  DATA_FULL: 75,      // å…¨å®½æ•°æ®åˆ—
  DATA_EXTRA: 88,     // è¶…å®½æ•°æ®åˆ—
  CONTENT: 98         // å†…å®¹åˆ—
}
```

### è¾¹è·å¸¸é‡

```javascript
const MARGINS = {
  TOP: 1440,          // ä¸Šè¾¹è· 1è‹±å¯¸
  BOTTOM: 1440,       // ä¸‹è¾¹è· 1è‹±å¯¸
  LEFT: 720,          // å·¦è¾¹è· 0.5è‹±å¯¸
  RIGHT: 720          // å³è¾¹è· 0.5è‹±å¯¸
}

const INDENTS = {
  CONTENT_LEFT: 400,  // å†…å®¹å·¦ç¼©è¿›
  CONTENT_RIGHT: 200  // å†…å®¹å³ç¼©è¿›
}
```

---

## ğŸ” å•ä½è¯´æ˜

### Twipå•ä½

Wordæ–‡æ¡£ä½¿ç”¨ Twip (Twentieth of a Point) ä½œä¸ºåŸºæœ¬å•ä½ã€‚

**æ¢ç®—å…³ç³»**:
- 1 ç‚¹ (pt) = 20 twips
- 1 è‹±å¯¸ = 1440 twips (72pt)
- 1 å˜ç±³ â‰ˆ 567 twips

**å¸¸ç”¨æ¢ç®—**:
```javascript
// å­—å·
12pt = 24 twips
14pt = 28 twips
16pt = 32 twips
36pt = 72 twips

// è¾¹è·
1è‹±å¯¸ = 1440 twips
0.5è‹±å¯¸ = 720 twips
2å˜ç±³ â‰ˆ 1134 twips

// ç¼©è¿›
0.5å˜ç±³ â‰ˆ 283 twips
1å˜ç±³ â‰ˆ 567 twips
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. å¤§æ–‡æœ¬å¤„ç†

```javascript
// å¦‚æœå†…å®¹è¶…è¿‡5000å­—ç¬¦ï¼Œè€ƒè™‘åˆ†æ®µå¤„ç†
if (text.length > 5000) {
  // æŒ‰æ®µè½åˆ†å‰²
  const paragraphs = text.split('\n')
  return paragraphs.map(p => createContentParagraph(p))
} else {
  return [createContentParagraph(text)]
}
```

### 2. å†…å­˜ä¼˜åŒ–

```javascript
// ç”Ÿæˆå®Œæˆåç«‹å³è¿”å›Bufferï¼Œé¿å…é•¿æ—¶é—´æŒæœ‰Documentå¯¹è±¡
const doc = new Document({ ... })
const buffer = await Packer.toBuffer(doc)
// doc = null  // é‡Šæ”¾å¼•ç”¨ï¼ˆå¯é€‰ï¼‰
return buffer
```

### 3. æ‰¹é‡ç”Ÿæˆ

```javascript
// æ‰¹é‡ç”Ÿæˆæ—¶ä½¿ç”¨é˜Ÿåˆ—ï¼Œé¿å…å†…å­˜æº¢å‡º
const queue = require('async-queue')
const wordQueue = queue(1)  // åŒæ—¶åªç”Ÿæˆ1ä¸ªWordæ–‡æ¡£

async function generateWordInQueue(logData) {
  return wordQueue.add(async () => {
    return await generateSupervisionLogWord(logData)
  })
}
```

---

## ğŸ› å¸¸è§é—®é¢˜

### 1. ä¸­æ–‡æ˜¾ç¤ºä¹±ç 

**é—®é¢˜**: ç”Ÿæˆçš„Wordæ–‡æ¡£ä¸­æ–‡æ˜¾ç¤ºä¸ºä¹±ç 

**åŸå› **: 
- æ•°æ®åº“å­—ç¬¦é›†ä¸æ˜¯ utf8mb4
- å­—ä½“è®¾ç½®é”™è¯¯

**è§£å†³**:
```javascript
// ç¡®ä¿æ‰€æœ‰TextRunä½¿ç”¨å®‹ä½“
new TextRun({
  text: 'ä¸­æ–‡å†…å®¹',
  font: 'å®‹ä½“'  // å¿…é¡»è®¾ç½®
})

// æ•°æ®åº“è¿æ¥é…ç½®
{
  charset: 'utf8mb4'
}
```

---

### 2. è¡¨æ ¼åˆ—å®½ä¸æ­£ç¡®

**é—®é¢˜**: è¡¨æ ¼åˆ—å®½æ˜¾ç¤ºä¸é¢„æœŸä¸ç¬¦

**åŸå› **:
- åˆ—å®½ç™¾åˆ†æ¯”æ€»å’Œä¸æ˜¯100%
- æœªè®¾ç½®è¡¨æ ¼å®½åº¦ç±»å‹

**è§£å†³**:
```javascript
// ç¡®ä¿è¡¨æ ¼å®½åº¦ä¸º100%
new Table({
  width: {
    size: 100,
    type: WidthType.PERCENTAGE  // å¿…é¡»è®¾ç½®
  },
  // ...
})

// ç¡®ä¿åˆ—å®½æ€»å’Œä¸º100%
// è¡Œ1: 25% + 75% = 100% âœ“
// è¡Œ2: 25% + 25% + 25% + 25% = 100% âœ“
```

---

### 3. åˆ†é¡µç¬¦ä¸ç”Ÿæ•ˆ

**é—®é¢˜**: æ·»åŠ åˆ†é¡µç¬¦åä»ç„¶åœ¨åŒä¸€é¡µ

**åŸå› **: 
- åˆ†é¡µç¬¦æœªåŒ…è£…åœ¨Paragraphä¸­
- åˆ†é¡µç¬¦ä½ç½®é”™è¯¯

**è§£å†³**:
```javascript
// æ­£ç¡®æ–¹å¼
new Paragraph({
  children: [new PageBreak()]
})

// é”™è¯¯æ–¹å¼
new PageBreak()  // âœ— å¿…é¡»åŒ…è£…åœ¨Paragraphä¸­
```

---

### 4. çºµå‘æ–‡å­—ä¸æ˜¾ç¤º

**é—®é¢˜**: çºµå‘æ–‡å­—æ˜¾ç¤ºä¸ºæ¨ªå‘

**åŸå› **: 
- ä½¿ç”¨äº†TextDirectionï¼ˆå·²å¼ƒç”¨ï¼‰
- æœªä½¿ç”¨æ¢è¡Œç¬¦

**è§£å†³**:
```javascript
// æ­£ç¡®æ–¹å¼ï¼ˆä½¿ç”¨æ¢è¡Œç¬¦ï¼‰
new TextRun({
  text: 'å·¥\nç¨‹\nåŠ¨\næ€'
})

// ä¸æ¨èæ–¹å¼ï¼ˆTextDirectionåœ¨æŸäº›ç‰ˆæœ¬ä¸æ”¯æŒï¼‰
textDirection: TextDirection.BOTTOM_TO_TOP_LEFT_TO_RIGHT
```

---

### 5. æ—¥æœŸæ ¼å¼é”™è¯¯

**é—®é¢˜**: æ—¥æœŸæ˜¾ç¤ºä¸º "Invalid Date"

**åŸå› **:
- æ—¥æœŸå­—ç¬¦ä¸²æ ¼å¼é”™è¯¯
- æ—¥æœŸä¸ºnullæˆ–undefined

**è§£å†³**:
```javascript
function formatDate(date) {
  if (!date) return ''  // å…ˆæ£€æŸ¥æ˜¯å¦ä¸ºç©º
  
  const d = new Date(date)
  if (isNaN(d.getTime())) return ''  // æ£€æŸ¥æ˜¯å¦æœ‰æ•ˆæ—¥æœŸ
  
  // æ ¼å¼åŒ–...
}
```

---

## ğŸ§ª æµ‹è¯•ç”¨ä¾‹

### å•å…ƒæµ‹è¯•ç¤ºä¾‹

```javascript
const { generateSupervisionLogWord } = require('./wordGenerator')
const fs = require('fs')

describe('Wordç”Ÿæˆå·¥å…·æµ‹è¯•', () => {
  
  test('åº”è¯¥ç”Ÿæˆæœ‰æ•ˆçš„Wordæ–‡æ¡£', async () => {
    const logData = {
      projectName: 'æµ‹è¯•é¡¹ç›®',
      projectCode: 'TEST-001',
      // ... å…¶ä»–å­—æ®µ
    }
    
    const buffer = await generateSupervisionLogWord(logData)
    
    expect(buffer).toBeInstanceOf(Buffer)
    expect(buffer.length).toBeGreaterThan(0)
  })
  
  test('åº”è¯¥å¤„ç†ç©ºå­—æ®µ', async () => {
    const logData = {
      projectName: '',
      projectCode: '',
      // ... å…¶ä»–å­—æ®µä¸ºç©º
    }
    
    const buffer = await generateSupervisionLogWord(logData)
    expect(buffer).toBeInstanceOf(Buffer)
  })
  
  test('åº”è¯¥æ­£ç¡®æ ¼å¼åŒ–æ—¥æœŸ', () => {
    const date = new Date('2024-11-08')
    const formatted = formatDate(date)
    expect(formatted).toBe('2024å¹´11æœˆ08æ—¥')
  })
  
  test('åº”è¯¥å¤„ç†æ— æ•ˆæ—¥æœŸ', () => {
    expect(formatDate(null)).toBe('')
    expect(formatDate('invalid')).toBe('')
  })
})
```

### é›†æˆæµ‹è¯•

```javascript
// test-word-generator.js
const { generateSupervisionLogWord } = require('./utils/wordGenerator')
const fs = require('fs')

async function testWordGenerator() {
  console.log('å¼€å§‹æµ‹è¯•Wordç”Ÿæˆå·¥å…·...')
  
  // æµ‹è¯•æ•°æ®
  const logData = {
    projectName: 'æŸæŸå»ºè®¾é¡¹ç›®ç›‘ç†å·¥ç¨‹',
    projectCode: 'PROJ-2024-001',
    organization: 'æŸæŸç›‘ç†æœ‰é™å…¬å¸',
    chiefEngineer: 'å¼ æ€»ç›‘',
    workName: 'ä¸»ä½“ç»“æ„å·¥ç¨‹',
    workCode: 'WORK-2024-001',
    unitWork: '1#æ¥¼',
    userName: 'æå·¥',
    logDate: new Date('2024-11-08'),
    weather: 'æ™´ï¼Œæ¸©åº¦15-25â„ƒï¼Œä¸œé£3çº§',
    startDate: new Date('2024-01-01'),
    endDate: new Date('2024-12-31'),
    projectDynamics: 'ä»Šæ—¥æ–½å·¥è¿›å±•é¡ºåˆ©ï¼Œå®Œæˆä¸»ä½“ç»“æ„ç¬¬5å±‚æµ‡ç­‘å·¥ä½œã€‚æ–½å·¥äººå‘˜30äººï¼Œæœºæ¢°è®¾å¤‡è¿è½¬æ­£å¸¸ã€‚',
    supervisionWork: 'ç›‘ç†äººå‘˜å…¨å¤©åˆ°åœºç›‘ç£æ–½å·¥ï¼Œé‡ç‚¹æ£€æŸ¥äº†é’¢ç­‹ç»‘æ‰ã€æ¨¡æ¿æ”¯è®¾ã€æ··å‡åœŸæµ‡ç­‘ç­‰å·¥åºã€‚å‘ç°å¹¶ç£ä¿ƒæ•´æ”¹3å¤„é’¢ç­‹é—´è·ä¸ç¬¦åˆè¦æ±‚çš„é—®é¢˜ã€‚',
    safetyWork: 'è¿›è¡Œäº†æ—¥å¸¸å®‰å…¨å·¡æŸ¥ï¼Œé‡ç‚¹æ£€æŸ¥äº†ä¸´è¾¹é˜²æŠ¤ã€é«˜å¤„ä½œä¸šå®‰å…¨æªæ–½ã€‚æœªå‘ç°é‡å¤§å®‰å…¨éšæ‚£ã€‚ç£ä¿ƒæ•´æ”¹2å¤„å®‰å…¨éšæ‚£ï¼šè„šæ‰‹æ¶æ‰£ä»¶æ¾åŠ¨ã€å®‰å…¨ç½‘ç ´æŸã€‚',
    recorderName: 'ç‹å·¥',
    recorderDate: new Date('2024-11-08'),
    reviewerName: 'ææ€»ç›‘',
    reviewerDate: new Date('2024-11-09')
  }
  
  try {
    // ç”ŸæˆWord
    const buffer = await generateSupervisionLogWord(logData)
    
    // ä¿å­˜æ–‡ä»¶
    const filename = `test-output/ç›‘ç†æ—¥å¿—æµ‹è¯•_${Date.now()}.docx`
    fs.writeFileSync(filename, buffer)
    
    console.log('âœ… Wordæ–‡æ¡£ç”ŸæˆæˆåŠŸ')
    console.log(`æ–‡ä»¶è·¯å¾„: ${filename}`)
    console.log(`æ–‡ä»¶å¤§å°: ${buffer.length} å­—èŠ‚`)
    
    return true
  } catch (error) {
    console.error('âŒ Wordæ–‡æ¡£ç”Ÿæˆå¤±è´¥:', error)
    return false
  }
}

// è¿è¡Œæµ‹è¯•
testWordGenerator()
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

### docxåº“æ–‡æ¡£
- å®˜æ–¹æ–‡æ¡£: https://docx.js.org/
- GitHub: https://github.com/dolanmiu/docx
- APIå‚è€ƒ: https://docx.js.org/api/

### ç›¸å…³æ ‡å‡†
- Office Open XMLæ ‡å‡†: ISO/IEC 29500
- WordprocessingMLè§„èŒƒ

---

## ğŸ”„ ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|---------|
| v1.0.0 | 2024-11-08 | åˆå§‹ç‰ˆæœ¬ï¼Œå®ç°å®Œæ•´Wordç”ŸæˆåŠŸèƒ½ |
| - | - | æ”¯æŒå°é¢é¡µå’Œå†…å®¹é¡µ |
| - | - | æ”¯æŒä¸­æ–‡æ—¥æœŸæ ¼å¼åŒ– |
| - | - | æ”¯æŒå¤æ‚è¡¨æ ¼å¸ƒå±€ |
| - | - | æ”¯æŒçºµå‘æ–‡å­—æ’ç‰ˆ |
| - | - | æ”¯æŒç­¾åæ å·¦å³å¯¹é½ |

---

**æ–‡æ¡£ç»“æŸ**





