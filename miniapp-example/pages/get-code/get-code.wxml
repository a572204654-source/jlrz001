<!--获取微信登录 Code 测试页面-->
<view class="container">
  <view class="header">
    <text class="title">微信登录 Code 获取工具</text>
    <text class="desc">用于测试后端登录接口</text>
  </view>

  <!-- 当前 Code 区域 -->
  <view class="section">
    <view class="section-title">
      <text>当前 Code</text>
      <text class="tip">（有效期5分钟，只能使用一次）</text>
    </view>
    
    <view class="code-box">
      <text class="code-text" wx:if="{{code}}">{{code}}</text>
      <text class="code-placeholder" wx:else>点击下方按钮获取 Code</text>
    </view>

    <view class="button-group">
      <button 
        type="primary" 
        bindtap="getCode"
        loading="{{loading}}"
        disabled="{{loading}}"
      >
        {{loading ? '获取中...' : '获取 Code'}}
      </button>
      
      <button 
        wx:if="{{code}}"
        bindtap="copyCode"
      >
        复制 Code
      </button>
    </view>
  </view>

  <!-- 历史记录区域 -->
  <view class="section" wx:if="{{codeHistory.length > 0}}">
    <view class="section-title">
      <text>历史记录</text>
      <text class="clear-btn" bindtap="clearHistory">清空</text>
    </view>
    
    <view class="history-list">
      <view 
        class="history-item" 
        wx:for="{{codeHistory}}" 
        wx:key="index"
        bindtap="copyHistoryCode"
        data-code="{{item.code}}"
      >
        <view class="history-time">{{item.time}}</view>
        <view class="history-code">{{item.code}}</view>
        <text class="copy-hint">点击复制</text>
      </view>
    </view>
  </view>

  <!-- 使用说明 -->
  <view class="section">
    <view class="section-title">
      <text>使用说明</text>
    </view>
    <view class="tips">
      <text class="tip-item">1. 点击"获取 Code"按钮获取微信登录 code</text>
      <text class="tip-item">2. Code 会自动复制到剪贴板（或手动点击"复制 Code"）</text>
      <text class="tip-item">3. 在 Postman 或其他工具中使用此 code 测试登录接口</text>
      <text class="tip-item">4. 每个 code 只能使用一次，如需再次测试请重新获取</text>
      <text class="tip-item">5. Code 有效期为 5 分钟，过期后需要重新获取</text>
    </view>
  </view>
</view>

